<!DOCTYPE html><!--[if lte IE 7]> <html class="no-js ie67 ie678" lang="en"> <![endif]-->
<!--[if IE 8]> <html class="no-js ie8 ie678" lang="en"> <![endif]-->
<!--[if IE 9]> <html class="no-js ie9" lang="en"> <![endif]--><html lang="en"><head><meta charset="utf-8"><!--[if lt IE 9]>
<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
<![endif]--><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"><meta name="viewport" content="width=device-width"><link rel="shortcut icon" href="/assets/images/favicon.png"><title>Localize your applications</title><link  rel="stylesheet" href="/vendors/css/knacss.css" /><link  rel="stylesheet" href="/vendors/css/sunburst.css" /><link  rel="stylesheet" href="/assets/css/main.css" /><link  rel="stylesheet" href="/assets/css/home.css" /></head><body><div class="navbar fixed"><a href="/" class="nav-logo left"><img src="/assets/images/happycloud.png" alt="Happy Cloud"></a><span class="subtitle">Localize your applications</span><a href="/hack/getting-started/" class="right">hack</a><a href="/host/install.html" class="right">host</a></div><div class="wrapper"><aside class="mod left w25 aside"><nav id="navigation" role="navigation"><ul class="first-level"><li class="big"><a href="/hack/getting-started/" class="label">Getting started</a></li><li class="big selected"><a href="/hack/cookbooks/" class="label">Cookbooks</a><ul class="second-level"><li class="small"><a href="/hack/cookbooks/data-system.html" class="label">The Data System API</a></li><li class="small"><a href="/hack/cookbooks/data-system-odm.html" class="label">The ODM for Data System API</a></li><li class="small"><a href="/hack/cookbooks/localization.html" class="label selected">Localize your applications</a></li></ul></li><li class="big"><a href="/hack/application-skeletons/" class="label">Application Skeletons</a></li><li class="big"><a href="/hack/contributing/" class="label">Contributing</a></li></ul></nav></aside><div id="main" role="main" class="mod pam w75"><h1 id="localize-your-applications">Localize your applications</h1>
<p>To improve your application user experience you might want to translate it (by yourself or by getting external contribution). This cookbook will provide you the information you need and give you the guidelines we use in Cozy apps. You are free to use your own but if everyone follows the same rules contributions will be eased.</p>
<h2 id="making-your-app-translatable">Making your app translatable</h2>
<p>We didn&#39;t invented anything new here, we just made helper to ease the developer&#39;s life.
We&#39;ll use the final code of our tutorial to illustrate this cookbook. You can find it <a href="https://github.com/mycozycloud/cozy-tutorial/tree/spa-final">here</a>.</p>
<p>NB: you can find the code of this tutorial <a href="https://github.com/mycozycloud/cozy-tutorial/tree/localization">here</a></p>
<p>First you need to add Polyglot to your client&#39;s vendor. <a href="http://airbnb.github.io/polyglot.js/">Polyglot</a> is a &quot;tiny l18n helper library written in JavaScript&quot;. It supports interpolation and pluralization.</p>
<ul>
<li>download it and put it inside the client/vendors/scripts/ folder</li>
<li>make sure brunch is running, it will automatically add the library to the vendor.js file</li>
</ul>
<p>Next, create your &quot;locales&quot; files (one for each language) in your client. As an example, you can see how we did it for the <a href="https://github.com/mycozycloud/cozy-home/tree/master/client/app/locales">&quot;Home&quot; application</a>.
We&#39;ll have english and french for our bookmark tutorial app:</p>
<pre class="highlighted"><code class="javascript"><span class="comment">// client/app/locales/en.js</span>
module.exports = {
    <span class="string">"main title"</span>: <span class="string">"Welcome on My Own Bookmarks"</span>,
    <span class="string">"main description"</span>: <span class="string">"This application will help you manage your bookmarks!"</span>,
    <span class="string">"form title label"</span>: <span class="string">"Title"</span>,
    <span class="string">"form url label"</span>: <span class="string">"Url"</span>,
    <span class="string">"form submit button"</span>: <span class="string">"Add a new bookmark"</span>,
    <span class="string">"delete button"</span>: <span class="string">"delete"</span>
}</code></pre>
<pre class="highlighted"><code class="javascript"><span class="comment">// client/app/locales/fr.js</span>
module.exports = {
    <span class="string">"main title"</span>: <span class="string">"Bienvenue sur My Own Bookmarks"</span>,
    <span class="string">"main description"</span>: <span class="string">"Cette application vous permet de g√©rer vos marque-pages !"</span>,
    <span class="string">"form title label"</span>: <span class="string">"Titre"</span>,
    <span class="string">"form url label"</span>: <span class="string">"Url"</span>,
    <span class="string">"form submit button"</span>: <span class="string">"Ajouter un nouveau marque-page"</span>,
    <span class="string">"delete button"</span>: <span class="string">"supprimer"</span>
}</code></pre>
<p>Each localization file is a key-value list. The key should always be the same accross the file. We&#39;ll see how we use it later. We have rules to name the keys, you can find them at the <a href="#guidelines">end of this page</a>.</p>
<p>Then bootstrap Polyglot in your application:</p>
<pre class="highlighted"><code class="javascript"><span class="comment">// client/app/initialize.js</span>

$(document).ready(<span class="keyword">function</span>() {
    <span class="keyword">var</span> app = require(<span class="string">'application'</span>);

    <span class="keyword">var</span> locale = <span class="string">'en'</span>; <span class="comment">// default locale</span>

    <span class="comment">// we'll need to tweak the server to allow this</span>
    $.ajax(<span class="string">'cozy-locale.json'</span>, {
        success: <span class="keyword">function</span>(data) {
            locale = data.locale
            initializeLocale(locale);
        },
        error: <span class="keyword">function</span>() {
            initializeLocale(locale);
        }
    });

    <span class="comment">// let's define a function to initialize Polyglot</span>
    <span class="keyword">var</span> initializeLocale = <span class="keyword">function</span>(locale) {
        <span class="keyword">var</span> locales = {};
        <span class="keyword">try</span> {
            locales = require(<span class="string">'locales/'</span> + locale);
        }
        <span class="keyword">catch</span>(err) {
            locales = require(<span class="string">'locales/en'</span>);
        }

        <span class="keyword">var</span> polyglot = <span class="keyword">new</span> Polyglot();
        <span class="comment">// we give polyglot the data</span>
        polyglot.extend(locales);

        <span class="comment">// handy shortcut</span>
        window.t = polyglot.t.bind(polyglot);
        app.initialize();
    };
});</code></pre>
<p>Now we must make the &quot;cozy-locale.json&quot; resource available on the server. We have a helper for that:</p>
<pre class="highlighted"><code class="bash">npm install cozy-i18n-helper --save</code></pre>
<p>Then add the following to the &#39;common&#39; section of your configuration (if you are using americano or express):</p>
<pre class="highlighted"><code class="javascript"><span class="comment">// server/config.js</span>
require(<span class="string">'cozy-i18n-helper'</span>).middleware</code></pre>
<p>It automatically retrieves the locale data of the cozy&#39;s user and create the route that will allow the client the get it. Don&#39;t forget to add the &quot;CozyInstance&quot; doctype to your application&#39;s permission or you will get errors.</p>
<p>Now you can change all the templates and view using the &quot;t&quot; function. Let&#39;s change <code>client/app/templates/home.hade</code> as an example:</p>
<pre class="highlighted"><code class="xml">h1= t('main title')
p= t('main description')

form
    label= t('form title label')  + ':'
    input(type="text", name="title")
    label= t('form url label') + ':'
    input(type="text", name="url")
    input(id="add-bookmark", type="submit", value="#{t('form submit button')}")

ul</code></pre>
<p>To learn all the great thing Polyglot can do (interpolation and pluralization), please <a href="http://airbnb.github.io/polyglot.js/">read its documentation</a>.</p>
<p><a name="summary"></a>
If you want to test everything is working, go to <a href="http://localhost:9104/#account">http://localhost:9104/#account</a> and change the language.</p>
<h2 id="summary-for-translator-contributors">Summary for translator contributors</h2>
<p>If you are not a developer but still want to help the community by adding tanslation, here what should know/do. Let&#39;s say you want to add the german language to an application.</p>
<ul>
<li>the only technical requirement is git. If you don&#39;t know it and still want to help, we&#39;ll find another way (contact[at]cozycloud.cc).</li>
<li>get the application you want to translate on <a href="https://github.com/mycozycloud/">Github</a></li>
<li>check the client/app/locales folder<ul>
<li>if there is a &quot;de.js&quot; or &quot;de.coffee&quot; file, open it and make your changes</li>
<li>if there isn&#39;t, create it on the existing model and make your changes</li>
</ul>
</li>
<li>commit your work</li>
<li>submit a pull request on github</li>
</ul>
<p><a name="guidelines"></a></p>
<h2 id="localization-guidelines">Localization guidelines</h2>
<p>This is how you should name the keys of your localization files:</p>
<ul>
<li>key names should not contain punctuation</li>
<li>key names should be lowercased</li>
<li>key names should contain spaces rather than hyphens</li>
<li>key names should be no longer than 30 chars or 4 words</li>
<li>key names should be (as much as possible) understandable by themselves.</li>
<li>key names should be in english</li>
</ul>
<p>Some examples :</p>
<ul>
<li>&quot;Choose the language you want me to use to speak to you:&quot; --&gt; &quot;choose language&quot;</li>
<li>&quot;Changing the locale requires to reload the page.&quot; --&gt; &quot;reload to change locales&quot;</li>
<li>&quot;Once updated, this application will require the following permissions:&quot; --&gt; &quot;permissions after update&quot;</li>
</ul>
</div><footer id="footer" role="contentinfo" class="line pam row"><a href="https://github.com/mycozycloud">Github</a><a href="irc://irc.freenode.net/cozycloud">IRC</a><a href="mailto:contact@cozycloud.cc">Contact</a><a href="https://groups.google.com/forum/?fromgroups#!forum/cozy-cloud">mailing-list</a><a href="https://cozycloud.cc">Cozy Cloud</a></footer></div><script defer="defer"  src="/vendors/javascripts/jquery-2.0.3.min.js"></script><script defer="defer"  src="/assets/javascripts/main.js"></script></body></html>